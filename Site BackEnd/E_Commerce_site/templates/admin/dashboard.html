{% extends 'index.html' %}
{% load static %}

    {% block jsfiles %}
        <link href="https://cdn.jsdelivr.net/gh/hung1001/font-awesome-pro-v6@44659d9/css/all.min.css" rel="stylesheet" type="text/css" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    {% endblock jsfiles %}

    {% block title %}
        Admin - Dashboard
    {% endblock title %}

    {% block cssfiles %}
        <link rel="stylesheet" href="{% static 'css/products.css' %}">
        <link rel="stylesheet" href="{% static 'css/page_profile.css' %}">
        <link rel="stylesheet" href="{% static 'css/staff_main.css' %}">
        <link rel="stylesheet" href="{% static 'css/wishlist.css' %}">
        <link rel="stylesheet" href="{% static 'css/transactions.css' %}">
        <link rel="stylesheet" href="{% static 'css/admin.css' %}">
    {% endblock cssfiles %}

    {% block hclass_names %} class="staff-header" {% endblock hclass_names %}

    {% block nav_search %} {% endblock nav_search %}

    {% block nav_buttons %}
        <a href="{% url 'logout' %}">
            <button class="nav-btns">
                <i class="fa fa-sign-out" aria-hidden="true"></i> Log out
            </button>
        </a>

        <a href="{% url 'logout' %}">
            <div class="only-navicons">
                <i class="fa fa-sign-out" aria-hidden="true"></i>
            </div>
        </a>
    {% endblock nav_buttons %}

    {% block toggle_nav_user_part %}
    {% endblock toggle_nav_user_part %}

    {% block toggle_nav_staff_part %}
        <ul>

            <a href="{% url 'admin_dashboard' %}">
                <div >
                    <p class="p-link" >Dashboard</p>

                </div>

                <p class="g-icon">></p>
            </a>

            <a href="{% url 'statistics' %}">
                <div>
                    <p class="p-link" >Statistics</p>

                </div>

                <p class="g-icon">></p>
            </a>

            <a href="{% url 'admin_product_list' %}">
                <div  >
                    <p class="p-link">Products</p>

                </div>

                <p class="g-icon">></p>
            </a>

            <a href="{% url 'admin_add_product' %}">
                <div  >
                    <p class="p-link">Add | Edit Products</p>

                </div>

                <p class="g-icon">></p>
            </a>

            <a href="{% url 'admin_orders' %}">
                <div >
                    <p class="p-link">Orders</p>

                </div>

                <p class="g-icon">></p>
            </a>
            <a href="{% url 'admin_transactions' %}">
                <div >
                    <p class="p-link">Transactions</p>

                </div>

                <p class="g-icon">></p>
            </a>
            <a href="{% url 'logout' %}">
                <div >
                    <p class="p-link">Logout</p>

                </div>

                <p class="g-icon">></p>
            </a>
        </ul>
    {% endblock toggle_nav_staff_part %}

    {% block nav_2 %}{% endblock nav_2 %}

    {% block container %}

        <!-- Page Navigator -->

        <div class="navigator-products">

            <div class="n-p-contents">
                <a href="{% url 'admin_dashboard' %}">Admin > </a>
                
                <a href="{% url 'admin_dashboard' %}" style="color:gray">Dashboard</a>
            </div>
            
        </div>

        <!-- End Page Navigator -->

        <!-- Profile Container -->

        <div class="profile-container admin-dashboard-container">

            <!-- Profile Navigation -->

            <div class="profile-nav">

                <ul>
                    <a href="{% url 'admin_dashboard' %}" class="current-tab-profile">
                        <i style="padding-left:.2em;" class="fa-sharp fa-solid fa-objects-column"></i>
                        <li >Dashboard</li>
                    </a>

                    <a href="{% url 'statistics' %}">
                        <i style="padding-left:.2em;" class="fas fa-chart-simple"></i>
                        <li>Statistics</li>

                    </a>
                    
                    <a href="{% url 'admin_product_list' %}">
                        <i class="fa-sharp fa-solid fa-box-open-full"></i>
                        <li class="">Products</li>
                    </a>

                    <a href="{% url 'admin_add_product' %}">
                        <i class="fas fa-edit"></i>
                        <li class="">Add | Edit Products</li>
                    </a>

                    <a href="{% url 'admin_orders' %}">
                        <i class="fas fa-cart-shopping"></i>
                        <li class="">Orders</li>
                    </a>

                    <a href="{% url 'admin_transactions' %}">
                        <i class="fas fa-right-left"></i>
                        <li class="">Transactions</li>
                    </a>
                    <a href="{% url 'logout' %}">
                        <i class="fas fa-sign-out"></i>
                        <li class="">Log out</li>
                    </a>
                </ul>

            </div>

            <!-- End Profile Navigation -->

            <div class="dashboard-contents">
                
                <div class="title">Dashboard</div>

                <div class="total-sales-order-products">

                    <div class="total-sales-orders">

                        <div class="total-sales">

                            <div class="icon">
                                <div class="icon-t-s">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                            </div>

                            <div class="text-details">
                                <p>Total Sales</p>
                                <p class="amount">$ <span>{{total_earnings|floatformat}}</span></p>
                            </div>

                        </div>

                        <div class="total-orders">

                            <div class="icon">
                                <div class="icon-t-o">
                                    <i class="fas fa-cart-shopping"></i>
                                </div>
                            </div>      

                            <div class="text-details">
                                <p>Total Orders</p>
                                <p class="amount">{{total_orders}}</p>
                            </div>
                        </div>

                    </div>

                    <div class="total-products">

                        <div class="icon">
                            <div class="icon-t-p">
                            
                                <i class="fas fa-bag-shopping"></i>
                            </div>
                        </div>

                        <div class="text-details">
                            <p>Total Products</p>
                            <p class="amount">{{total_products}}</p>
                        </div>
                    </div>

                </div>

                <div class="sales-statistics-visitors">

                    <div class="sales-statistics">
                        <p style="text-align:center; font-size:11px;">Total Sales</p>
                        <canvas id="myChart"></canvas>
                    </div>

                    <div class="visitors">
                        <p style="text-align:center; font-size:11px;">Orders Frequency</p>
                        <canvas id="myChart1"></canvas>
                    </div>

                </div>

                <div class="latest-orders">
                    
                    <div class="title">Latest Orders</div>

                    <div class="order-container">

                        {% for order in orders %}

                        <div class="admin-order">

                            <div class="segment-one">

                                <div class="segment-one-sub">
                                    <p class="order-id">
                                        {{order.order_id}}
                                    </p>

                                    <p class="order-person">
                                        {{order.order_person_name}}
                                    </p>
                                </div>
                                <p class="order-person-email">
                                    {{order.order_person_email}}
                                </p>

                            </div>

                            <div class="segment-two">
                                <p class="order-total-amount">
                                    ${{order.order_total_price}}
                                </p>
                                <p class="order-date">
                                    {{order.order_date|date:"d-m-y"}}
                                </p>
                            </div>

                            {% if order.order_is_pending %}
                                <div class="order-status order-pending">
                                    <p>Pending</p>
                                </div>
                            {% elif order.order_is_cancelled %}
                                <div class="order-status order-cancelled">
                                    <p>Cancelled</p>
                                </div>
                            {% elif order.order_is_confirmed %}
                                <div class="order-status order-confirmed">
                                    <p>Confirmed</p>
                                </div>
                            {% else %}
                                <div class="order-status order-delivered">
                                    <p>Delivered</p>
                                </div>
                            {% endif %}

                        </div>

                        <div class="line"></div>
                        {% endfor %}

                    </div>

                    <div class="line"></div>

                </div>

            </div>

        </div>

        <!-- End Profile Container -->

    {% endblock container %}
    {% block footer_top %}
    {% endblock footer_top %}
    {% block footer_bottom %}
    {% endblock footer_bottom %}

    {% block js_bottom %}
        <script src="{% static 'js/admin.js' %}"></script>

        <script>

            // Analytics

            const ctx = document.getElementById('myChart');

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: {{months|safe}},
                    datasets: [{
                        label: 'Total sales',
                        data: {{total_sales|safe}},
                        backgroundColor: [
                          'rgba(255, 99, 132, 0.2)',
                          'rgba(255, 159, 64, 0.2)',
                          'rgba(255, 205, 86, 0.2)',
                          'rgba(75, 192, 192, 0.2)',
                          'rgba(54, 162, 235, 0.2)',
                          'rgba(153, 102, 255, 0.2)',
                          'rgba(201, 203, 207, 0.2)'
                        ],
                        borderColor: [
                          'rgb(255, 99, 132)',
                          'rgb(255, 159, 64)',
                          'rgb(255, 205, 86)',
                          'rgb(75, 192, 192)',
                          'rgb(54, 162, 235)',
                          'rgb(153, 102, 255)',
                          'rgb(201, 203, 207)'
                        ],

                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                          beginAtZero: true
                        }
                    }
                }
            });

            // Polar area chart

            const ctx1 = document.getElementById('myChart1');

            new Chart(ctx1, {
                type: 'polarArea',
                data: {
                    labels: {{months|safe}},
                    datasets: [{
                        label: 'Total orders',
                        data: {{confirmed_order_by_month|safe}},
                        backgroundColor: [
                          'rgba(255, 99, 132, 0.8)',
                          'rgba(255, 159, 64, 0.8)',
                          'rgba(255, 205, 86, 0.8)',
                          'rgba(75, 192, 192, 0.8)',
                          'rgba(54, 162, 235, 0.8)',
                          'rgba(153, 102, 255, 0.8)',
                          'rgba(201, 203, 207, 0.8)'
                        ],
                        borderColor: [
                          'rgb(255, 99, 132)',
                          'rgb(255, 159, 64)',
                          'rgb(255, 205, 86)',
                          'rgb(75, 192, 192)',
                          'rgb(54, 162, 235)',
                          'rgb(153, 102, 255)',
                          'rgb(201, 203, 207)'
                        ],

                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                          beginAtZero: true
                        }
                    }
                }
            });
        </script>

    {% endblock js_bottom %}
